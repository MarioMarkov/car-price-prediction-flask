<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="{{url_for('static', filename='js/get_models_ajax.js')}}"></script>
    <link href="{{url_for('static',filename='css/main.css')}}" rel="stylesheet">
    <link href="{{url_for('static',filename='css/custom.css')}}" rel="stylesheet">

    <title>Za Kolko?</title>
</head>
<body>
  <aside class="text-gray-600 body-font">
    <form action="">
      <div>Choose Type of Model</div>
    </form>
  </aside>
    <form   action="{{ url_for('predict') }}" method="post">
        <div class="form_title">
          Детайли за колата 
        </div>
        <div class="form_contents">
          <label for="brand">Марка:</label> <br>
          <select id="brand" name="brand">
            {%for i in range(0, len)%}
              <option value={{brands[i]}}> {{brands[i]}} </option>
            {%endfor%}
          </select> <br>
      
  
          <label for="model">Модел:</label><br>
          <select id="model" name="model">
          </select>
  
          <br>
          <label for="year">Година:</label><br>
          <input type="number" id="year" name="year">
          <br>
          <label for="fuel">Гориво:</label><br>
          <select id="fuel" name="fuel">
            <option value="p">Бензин</option>
            <option value="d">Дизел</option>
            <option value="g">Газ/Бензин</option>
            <option value="m">Метан/Бензин</option>
            <option value="e">Електричество</option>
            <option value="h">Хибрид</option>
          </select>
          <br>
          <label for="kms">Километри:</label><br>
          <input type="number" id="kms" name="kms">
          <br>
          <label for="transmission">Трансмисия:</label><br>
          <select id="transmission" name="transmission">
            <option value="0">Ръчни скорости</option>
            <option value="1">Автоматични скорости</option>
          </select>
          <br>
          <label for="2door">Врати:</label><br>
          <select id="2door" name="2door">
            <option value="0">4 врати</option>
            <option value="1">2 врати</option>
          </select>
          <br>
          <label for="color">Цвят:</label><br>
          <select id="color" name="color">
            <option value="blue">син</option>
            <option value="white">бял</option>
            <option value="black">черен</option>
            <option value="gray">сив</option>
            <option value="yellow">жълт</option>
            <option value="beige">бежов</option>
            <option value="bordo">бордо</option>
            <option value="bronze">бронзов</option>
            <option value="violet">виолетов</option>
            <option value="green">зелен</option>
            <option value="gold">златен</option>
            <option value="brown">кафяв</option>
            <option value="orange">оранжев</option>
            <option value="silver">сребърен</option>
            <option value="red">червен</option>
            <option value="purple">лилав</option>
            <option value="ohra">охра</option>
            <option value="perl">перла</option>
            <option value="pink">розов</option>
            <option value="chameleon">хамелеон</option>
  
          </select>
          <br>
  
          <label for="type">Тип:</label><br>
          <select id="type" name="type">
            <option value="sedan">седан</option>
            <option value="hatchback">хечбек</option>
            <option value="combi">комби</option>
            <option value="coupe">купе</option>
            <option value="cabrio">кабрио</option>
            <option value="jeep">джип</option>
            <option value="pickup">пикап</option>
            <option value="van">ван</option>
          </select>
          <br>
          <label for="displacement">Обем на двигателя:</label><br>
          <input type="number" id="displacement" name="displacement">
          <br>
          <label for="hp">Консики сили:</label><br>
          <input type="number" id="hp" name="hp">
          <br>
          <label for="euro">Евро Рейтинг:</label><br>
          <select id="euro" name="euro">
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
            <option value="6">6</option>
          </select>
          <br>
          <input type="submit" value="Submit">
        </div> <!-- form_contents -->
        

      </form> 
      <h4>{{ prediction_text }}</h4>
</body>

<script>
  
var e = document.getElementById("brand");

// Make get request when it first loads
var value = e.value;
var val = e.options[e.selectedIndex].text;
var xhr = new XMLHttpRequest();
xhr.open("GET", `http://127.0.0.1:5000/get_brands/${val}`);
xhr.send();

 //Handle the response
 xhr.onload = function() {
    if (xhr.status === 200) {
      //Parse the JSON response
      var carModels = JSON.parse(xhr.responseText).models;
      //Get the select element
      var select = document.getElementById("model");
      function removeOptions(selectElement) {
          var i, L = selectElement.options.length - 1;
          for(i = L; i >= 0; i--) {
              selectElement.remove(i);
          }
        }
      removeOptions(select);


      //Loop through the car models and add them as options to the select element
      for (var i = 0; i < carModels.length; i++) {
        var option = document.createElement("option");
        option.text = carModels[i];
        
        select.add(option);
      }

    } else {
      console.log("Error retrieving car models");
    }
  };

// Make get request when brand changes
e.addEventListener("change", function() {
  var value = e.value;
  var val = e.options[e.selectedIndex].text;
  var xhr = new XMLHttpRequest();
  xhr.open("GET", `http://127.0.0.1:5000/get_brands/${val}`);
  xhr.send();

  //Handle the response
  xhr.onload = function() {
    if (xhr.status === 200) {
      //Parse the JSON response
      var carModels = JSON.parse(xhr.responseText).models;
      //Get the select element
      var select = document.getElementById("model");
      function removeOptions(selectElement) {
          var i, L = selectElement.options.length - 1;
          for(i = L; i >= 0; i--) {
              selectElement.remove(i);
          }
        }
      removeOptions(select);


      //Loop through the car models and add them as options to the select element
      for (var i = 0; i < carModels.length; i++) {
        var option = document.createElement("option");
        option.text = carModels[i];
        
        select.add(option);
      }

    } else {
      console.log("Error retrieving car models");
    }
  };
});



</script>
</html>